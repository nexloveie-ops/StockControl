# 快速测试指南

## 服务器启动

```bash
npm run prototype
```

服务器将运行在: http://localhost:8080

---

## 测试账号

| 角色 | 用户名 | 密码 | 主页 |
|------|--------|------|------|
| 管理员 | admin | admin123 | /admin.html |
| 仓库管理员 | warehouse1 | warehouse123 | /prototype.html |
| 批发商户 | merchant_vip | merchant123 | /merchant.html |

---

## 测试流程

### 1. 测试权限控制 ✅

**步骤**:
1. 访问 http://localhost:8080/login.html
2. 使用 `merchant_vip` / `merchant123` 登录
3. 应该自动跳转到 `/merchant.html`
4. 尝试手动访问 `http://localhost:8080/inventory.html`
5. 应该被阻止并弹出提示，然后跳转回 `/merchant.html`

**预期结果**: ✅ 批发商无法访问仓库管理页面

---

### 2. 测试仓库订货功能 🛒

**步骤**:
1. 使用批发商账号登录
2. 点击"仓库订货"标签页
3. 查看仓库可用产品列表
4. 选择一个产品（例如：iPhone 15 Pro）
5. 在"订货数量"输入框中输入数量（例如：2）
6. 点击"订货"按钮
7. 确认订单信息
8. 等待订货成功提示

**预期结果**: 
- ✅ 显示仓库产品列表
- ✅ 可以输入订货数量
- ✅ 订货成功后显示提示
- ✅ 统计卡片中的"我的库存"数量增加

---

### 3. 测试批发商库存 📦

**步骤**:
1. 订货成功后，点击"我的库存"标签页
2. 查看库存列表
3. 应该能看到刚才订购的产品
4. 检查产品信息：
   - 产品名称
   - 类别
   - 库存数量
   - 成本价（批发价）
   - 零售价
   - 税务分类
   - 状态

**预期结果**:
- ✅ 显示批发商自己的库存
- ✅ 库存数量正确
- ✅ 价格信息完整
- ✅ 有"销售"按钮

---

### 4. 测试销售功能 💰

**步骤**:
1. 在"我的库存"页面
2. 找到有库存的产品
3. 点击"销售"按钮
4. 在弹出框中输入销售数量（例如：1）
5. 选择支付方式：
   - 点击"确定" = 刷卡
   - 点击"取消" = 现金
6. 确认销售信息
7. 等待销售成功提示

**预期结果**:
- ✅ 弹出销售数量输入框
- ✅ 可以选择支付方式
- ✅ 显示销售确认信息（产品、数量、单价、总额、支付方式）
- ✅ 销售成功后库存数量减少
- ✅ 显示剩余库存

---

### 5. 测试库存状态更新 🔄

**步骤**:
1. 继续销售产品，直到库存为0
2. 观察库存状态变化：
   - 库存充足 → 状态：正常（绿色）
   - 库存低于最小值 → 状态：库存低（黄色）
   - 库存为0 → 状态：缺货（红色）
3. 缺货后，"销售"按钮应该被禁用

**预期结果**:
- ✅ 库存状态自动更新
- ✅ 缺货时无法销售
- ✅ 状态标识清晰

---

### 6. 测试仓库库存减少 📉

**步骤**:
1. 登出批发商账号
2. 使用 `warehouse1` / `warehouse123` 登录
3. 进入"库存管理"页面
4. 查找之前批发商订购的产品
5. 检查仓库库存数量是否减少

**预期结果**:
- ✅ 仓库库存数量正确减少
- ✅ 如果是配件类，数量减少对应数量
- ✅ 如果是设备类，状态变为"已售"

---

### 7. 测试统计数据 📊

**步骤**:
1. 使用批发商账号登录
2. 查看顶部统计卡片：
   - 我的库存：应该显示总库存数量
   - 本月销售：应该显示销售金额
   - 本月维修：应该显示维修金额
   - 应缴税额：应该显示税额

**预期结果**:
- ✅ 统计数据实时更新
- ✅ 数据准确

---

### 8. 测试税务报表 📋

**步骤**:
1. 点击"税务报表"标签页
2. 选择日期范围（默认是本月）
3. 点击"生成报表"按钮
4. 查看报表内容：
   - 日销售汇总
   - 税务计算明细
   - 总应缴税额

**预期结果**:
- ✅ 报表生成成功
- ✅ 显示日销售数据
- ✅ 税务计算正确
- ✅ 有计算说明

---

## 常见问题

### Q1: 仓库订货页面显示"暂无可订购产品"
**A**: 需要先在仓库管理系统中添加产品。使用 `warehouse1` 账号登录，在仓库管理页面添加产品。

### Q2: 订货后库存没有更新
**A**: 刷新页面或重新进入"我的库存"标签页。

### Q3: 销售时提示"库存不足"
**A**: 检查库存数量，确保销售数量不超过可用库存。

### Q4: 无法访问某个页面
**A**: 检查登录的用户角色，确保有权限访问该页面。

### Q5: 统计数据不准确
**A**: 统计数据基于测试数据，可能需要重新生成测试数据。

---

## 测试数据生成

如果需要生成测试数据：

```bash
node scripts/seed-merchant-test-data.js
```

这将生成：
- 30天的销售记录
- 维修记录
- 测试用的批发商数据

---

## 清理测试数据

如果需要清理数据库重新开始：

```javascript
// 在MongoDB中执行
use 3c-product-system
db.merchantinventories.deleteMany({})
db.merchantorders.deleteMany({})
```

---

## 性能测试

### 测试场景1: 大量订货
1. 连续订购10个不同产品
2. 观察响应时间
3. 检查库存是否正确

### 测试场景2: 快速销售
1. 连续销售同一产品多次
2. 观察库存更新速度
3. 检查数据一致性

### 测试场景3: 并发操作
1. 同时打开多个浏览器标签
2. 使用同一批发商账号
3. 同时进行订货和销售
4. 检查数据是否正确

---

## 浏览器兼容性

已测试浏览器：
- ✅ Chrome 120+
- ✅ Edge 120+
- ✅ Firefox 120+
- ⚠️ Safari（部分功能可能需要调整）

---

## 移动端测试

1. 使用浏览器的开发者工具
2. 切换到移动设备模式
3. 测试响应式布局
4. 检查触摸操作

---

## 测试检查清单

- [ ] 权限控制正常工作
- [ ] 批发商可以从仓库订货
- [ ] 订货后库存正确增加
- [ ] 仓库库存正确减少
- [ ] 批发商可以销售产品
- [ ] 销售后库存正确减少
- [ ] 库存状态自动更新
- [ ] 统计数据准确
- [ ] 税务报表生成正确
- [ ] 页面响应速度快
- [ ] 错误提示清晰
- [ ] 用户体验流畅

---

## 报告问题

如果发现问题，请记录：
1. 问题描述
2. 重现步骤
3. 预期结果
4. 实际结果
5. 浏览器和版本
6. 截图或错误信息

---

**祝测试顺利！** 🎉
