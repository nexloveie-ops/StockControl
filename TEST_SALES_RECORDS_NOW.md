# 🔍 立即测试：销售记录查询

## 快速测试（2分钟）

### 前提条件
确保已经完成至少一笔销售。如果没有，请先：
1. 登录商户账号：merchant_001 / merchant123
2. 进入"销售业务"标签
3. 添加产品到购物车并完成支付

### 测试步骤

#### 步骤 1：进入销售记录查询
1. 在"销售业务"标签页向下滚动
2. 找到"销售记录查询"部分
3. **看到什么**：
   - 两个日期输入框（开始日期、结束日期）
   - "查询销售记录"按钮
   - 默认已填充本月日期

#### 步骤 2：查询今天的销售
1. 确认日期范围包含今天
2. 点击"查询销售记录"按钮
3. **看到什么**：
   - 显示"查询中..."（短暂）
   - 然后显示销售记录表格

#### 步骤 3：查看销售记录表格
**表格列**：
- 日期（精确到分钟）
- 产品名称
- 序列号（设备有，配件显示"-"）
- 数量
- 单价
- 销售额（单价×数量）
- 成本
- 税额
- 税务分类（VAT 23%等标签）
- 支付方式（现金/刷卡/混合）
- 客户电话（有则显示，无则"-"）

**表格底部**：
- 合计行（销售额、成本、税额总计）

#### 步骤 4：查看统计摘要
在表格下方的蓝色卡片中：
```
┌─────────────┬─────────────┬─────────────┐
│ 销售记录数  │ 商品总数    │ 总利润      │
│     X       │      X      │   €XXX.XX   │
└─────────────┴─────────────┴─────────────┘
```

#### 步骤 5：验证混合支付显示
如果有混合支付的记录：
- 支付方式列显示"混合"标签（黄色）
- 下方显示：
  ```
  现金€XX.XX
  刷卡€XX.XX
  ```

## 预期结果

### 有销售记录时
✅ 显示完整的销售记录表格  
✅ 每个商品单独一行  
✅ 显示所有详细信息  
✅ 合计行正确计算  
✅ 统计摘要显示正确数字  
✅ 混合支付显示详细金额  

### 无销售记录时
✅ 显示"该时间段内无销售记录"  

## 测试不同场景

### 场景 A：查询特定日期
1. 选择开始日期：2026-02-02
2. 选择结束日期：2026-02-02
3. 点击查询
4. **预期**：只显示2月2日的销售

### 场景 B：查询本月
1. 选择开始日期：本月1日
2. 选择结束日期：今天
3. 点击查询
4. **预期**：显示本月所有销售

### 场景 C：查询无销售日期
1. 选择一个没有销售的日期范围
2. 点击查询
3. **预期**：显示"该时间段内无销售记录"

## 数据验证

### 验证销售额
- 销售额 = 单价 × 数量
- 合计销售额 = 所有行的销售额之和

### 验证利润
- 单个商品利润 = (单价 - 成本价) × 数量
- 总利润 = 所有商品利润之和

### 验证税额
- VAT 23%：税额 ≈ 销售额 × 23/123
- Service VAT 13.5%：税额 ≈ 销售额 × 13.5/113.5
- Margin VAT：税额 ≈ (销售额 - 成本) × 23/123

## 常见问题

**Q: 点击查询后显示"该时间段内无销售记录"？**
A: 
- 确认日期范围包含销售日期
- 确认已经完成至少一笔销售
- 刷新页面重试

**Q: 表格显示不完整？**
A: 
- 横向滚动查看所有列
- 或者放大浏览器窗口

**Q: 混合支付没有显示金额详情？**
A: 
- 确认是混合支付的记录
- 检查浏览器控制台是否有错误

**Q: 统计摘要的数字不对？**
A: 
- 刷新页面重新查询
- 检查是否有多笔销售被合并显示

## 调试技巧

### 检查API响应
打开浏览器开发者工具（F12）：
1. 切换到"Network"标签
2. 点击"查询销售记录"
3. 找到 `/api/merchant/sales` 请求
4. 查看响应数据

### 检查控制台错误
打开浏览器开发者工具（F12）：
1. 切换到"Console"标签
2. 查看是否有红色错误信息
3. 如有错误，记录错误信息

## 成功标志

✅ 能查询到销售记录  
✅ 表格显示完整信息  
✅ 合计行计算正确  
✅ 统计摘要显示正确  
✅ 混合支付显示详细金额  
✅ 日期范围过滤正常工作  

## 服务器信息
- 地址：http://localhost:3000
- 进程ID：14
- 状态：✅ 运行中

## 下一步
测试成功后，可以：
- 查看不同日期范围的销售
- 分析销售数据和利润
- 生成税务报表
- 导出销售记录（未来功能）
