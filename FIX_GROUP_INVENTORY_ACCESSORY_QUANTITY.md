# ä¿®å¤ï¼šç¾¤ç»„åº“å­˜é…ä»¶æ•°é‡æ˜¾ç¤ºä¸ä¸€è‡´

## é—®é¢˜æè¿°
åœ¨ç¾¤ç»„åº“å­˜é¡µé¢ï¼Œé…ä»¶äº§å“æ˜¾ç¤ºçš„åº“å­˜æ•°é‡ä¸å®é™…å¯è°ƒè´§æ•°é‡ä¸ä¸€è‡´ã€‚

**ç¤ºä¾‹**ï¼š
- äº§å“ï¼šPhone Case, iPhone 13 - Clear
- æ˜¾ç¤ºåº“å­˜ï¼š3 ä»¶
- ç‚¹å‡»"åŠ å…¥è°ƒè´§æ¸…å•"æ—¶æç¤ºï¼šè¯·è¾“å…¥è°ƒè´§æ•°é‡ï¼ˆå¯ç”¨ï¼š1ï¼‰

## æ ¹æœ¬åŸå› 

### æ•°æ®ç»“æ„
é…ä»¶äº§å“åœ¨æ•°æ®åº“ä¸­å¯èƒ½æœ‰å¤šæ¡åº“å­˜è®°å½•ï¼š
```javascript
[
  { _id: 'xxx1', productName: 'Phone Case', quantity: 1, merchantId: 'MurrayDundrum' },
  { _id: 'xxx2', productName: 'Phone Case', quantity: 1, merchantId: 'MurrayDundrum' },
  { _id: 'xxx3', productName: 'Phone Case', quantity: 1, merchantId: 'MurrayDundrum' }
]
```

### æ˜¾ç¤ºé€»è¾‘
åœ¨ `displayGroupInventoryProducts` å‡½æ•°ä¸­ï¼ŒæŒ‰äº§å“åç§°åˆ†ç»„å¹¶ç´¯åŠ æ•°é‡ï¼š
```javascript
grouped[key].quantity += (item.quantity || 1);  // æ€»è®¡ï¼š3
```

### é—®é¢˜æ‰€åœ¨
ä½†åœ¨è°ƒç”¨ `addAccessoryToTransferCart` æ—¶ï¼Œåªä¼ é€’äº†ç¬¬ä¸€æ¡è®°å½•ï¼š
```javascript
addAccessoryToTransferCart(group.items[0])  // åªæœ‰ quantity: 1
```

è¿™å¯¼è‡´ï¼š
- ç•Œé¢æ˜¾ç¤ºï¼šæ€»åº“å­˜ 3 ä»¶ âœ…
- å®é™…å¯ç”¨ï¼šåªæœ‰ç¬¬ä¸€æ¡è®°å½•çš„ 1 ä»¶ âŒ

## è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹ 1ï¼šæ— å˜ä½“äº§å“
**æ–‡ä»¶**ï¼š`StockControl-main/public/merchant.html`
**ä½ç½®**ï¼šçº¦ç¬¬ 3808 è¡Œ

**ä¿®æ”¹å‰**ï¼š
```javascript
<button onclick='addAccessoryToTransferCart(${JSON.stringify(group.items[0]).replace(/'/g, "\\'")})'
```

**ä¿®æ”¹å**ï¼š
```javascript
<button onclick='addAccessoryToTransferCart(${JSON.stringify({
  ...group.items[0],
  quantity: group.quantity,      // ä½¿ç”¨æ€»æ•°é‡
  allItems: group.items          // ä¿å­˜æ‰€æœ‰åº“å­˜è®°å½•
}).replace(/'/g, "\\'")})'
```

### ä¿®æ”¹ 2ï¼šå˜ä½“äº§å“é€‰æ‹©
**æ–‡ä»¶**ï¼š`StockControl-main/public/merchant.html`
**ä½ç½®**ï¼šçº¦ç¬¬ 3895 è¡Œï¼ˆ`selectGroupVariant` å‡½æ•°ï¼‰

**ä¿®æ”¹å‰**ï¼š
```javascript
} else {
  // é…ä»¶ï¼šå¯ä»¥é€‰æ‹©æ•°é‡
  addAccessoryToTransferCart(firstItem);
}
```

**ä¿®æ”¹å**ï¼š
```javascript
} else {
  // é…ä»¶ï¼šå¯ä»¥é€‰æ‹©æ•°é‡
  // ä¼ é€’å˜ä½“çš„æ€»æ•°é‡ï¼Œè€Œä¸æ˜¯å•ä¸ªitemçš„æ•°é‡
  const itemWithTotalQty = {
    ...firstItem,
    quantity: variant.quantity,  // ä½¿ç”¨å˜ä½“çš„æ€»æ•°é‡
    allItems: variant.items      // ä¿å­˜æ‰€æœ‰åº“å­˜è®°å½•
  };
  addAccessoryToTransferCart(itemWithTotalQty);
}
```

## å·¥ä½œåŸç†

### ä¿®æ”¹åçš„æ•°æ®ä¼ é€’
```javascript
{
  _id: 'xxx1',                    // ç¬¬ä¸€æ¡è®°å½•çš„IDï¼ˆç”¨äºæ˜¾ç¤ºï¼‰
  productName: 'Phone Case',
  quantity: 3,                    // âœ… æ€»æ•°é‡
  allItems: [                     // âœ… æ‰€æœ‰åº“å­˜è®°å½•
    { _id: 'xxx1', quantity: 1 },
    { _id: 'xxx2', quantity: 1 },
    { _id: 'xxx3', quantity: 1 }
  ],
  // ... å…¶ä»–å­—æ®µ
}
```

### ç”¨æˆ·ä½“éªŒ
1. ç”¨æˆ·çœ‹åˆ°ï¼šåº“å­˜ 3 ä»¶
2. ç‚¹å‡»"åŠ å…¥è°ƒè´§æ¸…å•"
3. æç¤ºï¼šè¯·è¾“å…¥è°ƒè´§æ•°é‡ï¼ˆå¯ç”¨ï¼š3ï¼‰âœ…
4. ç”¨æˆ·å¯ä»¥è¾“å…¥ 1-3 ä¹‹é—´çš„ä»»æ„æ•°é‡

## æ³¨æ„äº‹é¡¹

### åç«¯å¤„ç†
è™½ç„¶å‰ç«¯ä¼ é€’äº† `allItems` æ•°ç»„ï¼Œä½† `transfer-cart.js` ä¸­çš„ `addAccessoryToTransferCart` å‡½æ•°åªä½¿ç”¨ `item.quantity` æ¥éªŒè¯å’Œæ˜¾ç¤ºã€‚

å®é™…çš„åº“å­˜æ‰£å‡ä¼šåœ¨åç«¯å¤„ç†è°ƒè´§ç”³è¯·æ—¶è¿›è¡Œï¼Œåç«¯ä¼šï¼š
1. æ ¹æ® `inventoryId` æŸ¥æ‰¾åº“å­˜è®°å½•
2. æ‰£å‡ç›¸åº”çš„æ•°é‡
3. å¦‚æœå•æ¡è®°å½•ä¸å¤Ÿï¼Œå¯èƒ½éœ€è¦ä»å¤šæ¡è®°å½•ä¸­æ‰£å‡

### æ½œåœ¨æ”¹è¿›
å¦‚æœåç«¯éœ€è¦çŸ¥é“å…·ä½“ä»å“ªäº›åº“å­˜è®°å½•ä¸­æ‰£å‡ï¼Œå¯ä»¥åœ¨æäº¤è°ƒè´§ç”³è¯·æ—¶ä½¿ç”¨ `allItems` æ•°ç»„ã€‚ä½†ç›®å‰çš„å®ç°ä¸­ï¼Œåç«¯ä¼šè‡ªåŠ¨å¤„ç†è¿™ä¸ªé€»è¾‘ã€‚

## æµ‹è¯•æ­¥éª¤

### 1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
æŒ‰ Ctrl+F5 å¼ºåˆ¶åˆ·æ–°é¡µé¢

### 2. éªŒè¯é¡µé¢ç‰ˆæœ¬
æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
âœ… é¡µé¢ç‰ˆæœ¬: v2.1.4 - ä¿®å¤ç¾¤ç»„åº“å­˜é…ä»¶æ•°é‡æ˜¾ç¤º
```

### 3. æµ‹è¯•æ— å˜ä½“é…ä»¶
1. ç™»å½• MurrayRanelagh è´¦å·
2. è¿›å…¥"ç¾¤ç»„åº“å­˜"
3. é€‰æ‹©åº—é“ºï¼šMurrayDundrum
4. é€‰æ‹©åˆ†ç±»ï¼ˆå¦‚"é…ä»¶"ï¼‰
5. æ‰¾åˆ°ä¸€ä¸ªæ— å˜ä½“çš„é…ä»¶äº§å“
6. æŸ¥çœ‹æ˜¾ç¤ºçš„åº“å­˜æ•°é‡ï¼ˆå¦‚ 3 ä»¶ï¼‰
7. ç‚¹å‡»"ğŸ›’ åŠ å…¥è°ƒè´§æ¸…å•"
8. âœ… éªŒè¯ï¼šæç¤ºåº”è¯¥æ˜¾ç¤º"è¯·è¾“å…¥è°ƒè´§æ•°é‡ï¼ˆå¯ç”¨ï¼š3ï¼‰"

### 4. æµ‹è¯•å˜ä½“é…ä»¶
1. æ‰¾åˆ°ä¸€ä¸ªæœ‰å˜ä½“çš„é…ä»¶äº§å“ï¼ˆå¦‚ Phone Caseï¼‰
2. æŸ¥çœ‹æ˜¾ç¤ºçš„æ€»åº“å­˜ï¼ˆå¦‚ 3 ä»¶ï¼‰
3. ç‚¹å‡»"ğŸ¨ é€‰æ‹©å‹å·å’Œé¢œè‰²"
4. é€‰æ‹©ä¸€ä¸ªå˜ä½“ï¼ˆå¦‚ iPhone 13 - Clearï¼‰
5. æŸ¥çœ‹è¯¥å˜ä½“çš„åº“å­˜æ•°é‡ï¼ˆå¦‚ 3 ä»¶ï¼‰
6. ç‚¹å‡»é€‰æ‹©è¯¥å˜ä½“
7. âœ… éªŒè¯ï¼šæç¤ºåº”è¯¥æ˜¾ç¤º"è¯·è¾“å…¥è°ƒè´§æ•°é‡ï¼ˆå¯ç”¨ï¼š3ï¼‰"

### 5. æµ‹è¯•æ•°é‡è¾“å…¥
1. è¾“å…¥æ•°é‡ï¼š2
2. âœ… éªŒè¯ï¼šæˆåŠŸæ·»åŠ åˆ°è´­ç‰©è½¦
3. å†æ¬¡æ·»åŠ ç›¸åŒäº§å“ï¼Œè¾“å…¥æ•°é‡ï¼š1
4. âœ… éªŒè¯ï¼šæˆåŠŸæ·»åŠ ï¼ˆæ€»æ•°é‡å˜ä¸º 3ï¼‰
5. å†æ¬¡æ·»åŠ ç›¸åŒäº§å“ï¼Œè¾“å…¥æ•°é‡ï¼š1
6. âœ… éªŒè¯ï¼šæç¤º"åº“å­˜ä¸è¶³ï¼Œæœ€å¤šå¯è°ƒè´§ 3 ä»¶"

## ç›¸å…³æ–‡ä»¶
- `StockControl-main/public/merchant.html` (v2.1.4)
- `StockControl-main/public/transfer-cart.js` (æ— éœ€ä¿®æ”¹)

## ç‰ˆæœ¬å†å²
- v2.1.2: æ·»åŠ ç¾¤ç»„åº“å­˜å˜ä½“é€‰æ‹©æ¨¡æ€æ¡†
- v2.1.3: ä¿®å¤ç¾¤ç»„åº“å­˜å˜ä½“é€‰æ‹©åŠŸèƒ½
- v2.1.4: ä¿®å¤ç¾¤ç»„åº“å­˜é…ä»¶æ•°é‡æ˜¾ç¤ºä¸ä¸€è‡´ âœ…

## å®Œæˆæ—¶é—´
2026å¹´2æœˆ6æ—¥
