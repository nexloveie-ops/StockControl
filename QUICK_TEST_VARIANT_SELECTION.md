# 快速测试：变体选择功能

## 测试准备

### 1. 确认服务器运行
```
访问: http://localhost:3000
```

### 2. 确认已创建变体产品
使用阶段2的批量创建功能创建测试数据：
- iPhone Clear Case (3型号 × 3颜色 = 9变体)
- Tempered Glass Screen Protector (2型号 × 2类型 = 4变体)
- USB-C to Lightning Cable (3长度 × 2颜色 = 6变体)

### 3. 登录商户账号
- 用户名: `MurrayRanelagh` 或 `MurrayDundrum`
- 密码: 对应的密码

## 快速测试步骤

### 测试1: 查看变体产品 (1分钟)

1. 访问：http://localhost:3000/merchant.html
2. 登录商户账号
3. 点击"销售业务"标签
4. 选择"Phone Case"分类

**预期结果**:
- ✅ 看到 "iPhone Clear Case" 产品
- ✅ 显示"多种型号/颜色"标签
- ✅ 显示紫色的"选择型号和颜色"按钮
- ✅ 显示总库存数量

### 测试2: 打开变体选择对话框 (30秒)

1. 点击"选择型号和颜色"按钮

**预期结果**:
- ✅ 弹出对话框
- ✅ 标题显示"选择产品变体"
- ✅ 显示产品名称
- ✅ 显示"① 选择型号"区域
- ✅ 显示3个型号选项（iPhone 13, iPhone 14, iPhone 14 Pro）
- ✅ 每个选项显示库存数量

### 测试3: 选择型号 (30秒)

1. 点击"iPhone 13"选项

**预期结果**:
- ✅ iPhone 13 选项变为紫色（选中状态）
- ✅ 自动显示"② 选择颜色"区域
- ✅ 显示3个颜色选项（Clear, Black, Blue）
- ✅ 每个选项显示库存数量

### 测试4: 选择颜色 (30秒)

1. 点击"Clear"选项

**预期结果**:
- ✅ Clear 选项变为紫色（选中状态）
- ✅ 显示"已选择"信息框
- ✅ 显示"iPhone 13 - Clear"
- ✅ 显示库存数量
- ✅ 显示价格
- ✅ "加入购物车"按钮启用（不再灰色）

### 测试5: 加入购物车 (30秒)

1. 点击"加入购物车"按钮

**预期结果**:
- ✅ 对话框自动关闭
- ✅ 购物车显示新产品
- ✅ 产品名称：`iPhone Clear Case (iPhone 13 - Clear)`
- ✅ 价格正确
- ✅ 可以修改数量

### 测试6: 测试缺货处理 (1分钟)

1. 打开变体选择对话框
2. 选择一个型号
3. 观察颜色选项

**如果有缺货变体**:
- ✅ 缺货选项显示为灰色
- ✅ 显示"缺货"文字
- ✅ 不可点击

### 测试7: 完整销售流程 (2分钟)

1. 添加多个不同变体到购物车
2. 点击"结账"按钮
3. 选择支付方式
4. 完成销售

**预期结果**:
- ✅ 购物车正确显示所有产品
- ✅ 每个产品显示完整名称（包含型号和颜色）
- ✅ 总价计算正确
- ✅ 可以正常结账

## 验证清单

### 界面显示
- [ ] 配件产品按产品名称+品牌分组
- [ ] 显示"多种型号/颜色"标签
- [ ] "选择型号和颜色"按钮为紫色
- [ ] 总库存显示正确

### 变体选择对话框
- [ ] 对话框正确弹出
- [ ] 产品名称显示正确
- [ ] 维度1选项显示正确
- [ ] 维度2选项显示正确
- [ ] 库存数量显示正确

### 选择流程
- [ ] 选中型号后高亮显示
- [ ] 自动显示颜色选项
- [ ] 选中颜色后高亮显示
- [ ] 显示已选择信息
- [ ] "加入购物车"按钮启用

### 购物车集成
- [ ] 产品名称格式正确
- [ ] 价格正确
- [ ] 可以修改数量
- [ ] 可以删除产品
- [ ] 可以正常结账

### 缺货处理
- [ ] 缺货选项显示为灰色
- [ ] 显示"缺货"文字
- [ ] 不可点击

### 兼容性
- [ ] 设备产品（有序列号）正常工作
- [ ] 单一变体产品直接加入购物车
- [ ] 不影响现有功能

## 常见问题

### Q1: 没有看到"选择型号和颜色"按钮
**原因**: 
- 产品只有一个变体
- 产品是设备（有序列号）

**解决方法**:
- 确认产品有多个变体（至少2个不同的型号或颜色组合）
- 使用批量创建功能创建多个变体

### Q2: 对话框没有弹出
**原因**:
- JavaScript错误
- 浏览器兼容性问题

**解决方法**:
1. 打开浏览器控制台查看错误
2. 刷新页面重试
3. 使用Chrome/Edge/Firefox最新版本

### Q3: 选项显示不正确
**原因**:
- 数据问题
- 分组逻辑错误

**解决方法**:
1. 检查产品数据（model 和 color 字段）
2. 刷新页面重新加载数据
3. 查看浏览器控制台错误

### Q4: 加入购物车后名称不正确
**原因**:
- 产品名称格式化错误

**解决方法**:
1. 检查 addSelectedVariantToCart 函数
2. 确认 dimension1Value 和 dimension2Value 正确

## 性能测试

### 测试大量变体
1. 创建一个有很多变体的产品（如 5型号 × 5颜色 = 25变体）
2. 打开变体选择对话框
3. 测试选择流程

**预期**:
- ✅ 对话框快速打开
- ✅ 选项渲染流畅
- ✅ 选择响应迅速

## 下一步

测试完成后，可以：

1. 继续测试其他配件类型
   - Screen Protector
   - Cable
   - Charger

2. 测试边界情况
   - 所有变体都缺货
   - 只有一个变体有库存
   - 大量变体

3. 准备测试阶段4
   - 库存管理界面优化
   - 分组展开/折叠视图

---
**测试日期**: 2026-02-05
**测试人员**: ___________
**测试状态**: ⬜ 通过 ⬜ 未通过
**备注**: ___________
