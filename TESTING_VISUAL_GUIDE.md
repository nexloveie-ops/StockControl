# 🎨 用户管理和群组管理 - 可视化测试指南

## 📍 访问地址
```
http://localhost:3000/admin.html
```

---

## 🖥️ 界面预览

### 1️⃣ 用户管理主界面

当你点击"👥 用户管理"标签后，你会看到：

```
┌─────────────────────────────────────────────────────────────┐
│  👥 用户列表                                                  │
│  ┌──────────────┐  ┌──────────────┐                         │
│  │ 👥 群组管理   │  │ ➕ 添加用户   │                         │
│  └──────────────┘  └──────────────┘                         │
│                                                              │
│  筛选器:                                                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │ 角色筛选: 全部│  │ 状态筛选: 全部│  │ 群组筛选: 全部│      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
│                                                              │
│  搜索: [_____________________]                               │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 用户名 │ 邮箱 │ 角色 │ 所属群组 │ 状态 │ 操作           │ │
│  ├────────────────────────────────────────────────────────┤ │
│  │ admin  │ ... │ 管理员│    -    │ 活跃 │ [编辑] [停用] │ │
│  │ user1  │ ... │ 普通  │ 连锁店A │ 活跃 │ [编辑] [停用] │ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

**关键元素**:
- 🟢 **绿色按钮** "👥 群组管理" - 点击打开群组管理
- 🔴 **红色按钮** "➕ 添加用户" - 点击创建新用户
- 📊 **筛选器** - 按角色、状态、群组筛选
- 🔍 **搜索框** - 实时搜索用户名
- 📋 **用户列表** - 显示所有用户信息

---

### 2️⃣ 添加用户模态框

点击"➕ 添加用户"后，会弹出模态框：

```
┌─────────────────────────────────────────────────────────────┐
│  添加用户                                          [X]        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  基本信息                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ 用户名 *: [___________________]                       │  │
│  │ 邮箱 *:   [___________________]                       │  │
│  │ 密码 *:   [___________________]                       │  │
│  │ 角色 *:   [▼ 请选择角色        ]                      │  │
│  │           - 管理员                                     │  │
│  │           - 仓库管理员                                 │  │
│  │           - 普通用户                                   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  个人信息                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ 名字:     [___________________]                       │  │
│  │ 姓氏:     [___________________]                       │  │
│  │ 电话:     [___________________]                       │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  群组设置 (仅普通用户)                                        │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ 所属群组: [▼ 无群组（独立用户）]                      │  │
│  │           - 无群组（独立用户）                         │  │
│  │           - 连锁店A (CHAIN-A)                         │  │
│  │           - 连锁店B (CHAIN-B)                         │  │
│  │                                                        │  │
│  │ 店面类型: [▼ 单店              ]                      │  │
│  │                                                        │  │
│  │ ☑ 可以查看群组内其他店面库存                          │  │
│  │ ☑ 可以从群组内其他店面调货                            │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  账户状态                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ ☑ 账户激活                                            │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────┐  ┌──────────┐                                │
│  │   保存    │  │   取消    │                                │
│  └──────────┘  └──────────┘                                │
└─────────────────────────────────────────────────────────────┘
```

**重要提示**:
- ⭐ 带 * 的字段是必填项
- 🔵 选择"普通用户"角色后，"群组设置"区域会自动显示
- 🔵 选择其他角色时，"群组设置"区域会隐藏

---

### 3️⃣ 群组管理模态框

点击"👥 群组管理"按钮后，会弹出群组管理模态框：

```
┌─────────────────────────────────────────────────────────────┐
│  👥 群组管理                                                  │
│  ┌──────────────┐  ┌──────────┐                             │
│  │ ➕ 添加群组   │  │   关闭    │                             │
│  └──────────────┘  └──────────┘                             │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │ 群组名称 │ 代码 │ 用户 │ 库存共享 │ 调货 │ 状态 │ 操作 │ │
│  ├────────────────────────────────────────────────────────┤ │
│  │ 连锁店A  │CHAIN-A│ 3人 │    ✅    │  ✅  │ 活跃 │[编辑]│ │
│  │          │       │     │          │      │      │[停用]│ │
│  ├────────────────────────────────────────────────────────┤ │
│  │ 连锁店B  │CHAIN-B│ 0人 │    ✅    │  ✅  │ 活跃 │[编辑]│ │
│  │          │       │     │          │      │      │[停用]│ │
│  ├────────────────────────────────────────────────────────┤ │
│  │ 独立联盟 │INDIE  │ 2人 │    ✅    │  ❌  │ 活跃 │[编辑]│ │
│  │          │       │     │          │      │      │[停用]│ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

**列说明**:
- 📝 **群组名称** - 群组的显示名称
- 🏷️ **代码** - 群组的唯一代码（蓝色徽章）
- 👥 **用户** - 该群组的用户数量
- 📦 **库存共享** - 是否允许店面间库存共享
- 🚚 **调货** - 是否允许店面间调货
- 🟢 **状态** - 活跃（绿色）或停用（红色）
- ⚙️ **操作** - 编辑或停用按钮

---

### 4️⃣ 添加群组模态框

点击"➕ 添加群组"后，会弹出群组表单：

```
┌─────────────────────────────────────────────────────────────┐
│  添加群组                                          [X]        │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  基本信息                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ 群组名称 *: [___________________]                     │  │
│  │ 群组代码 *: [___________________]                     │  │
│  │             (自动转为大写，如: CHAIN-A)                │  │
│  │                                                        │  │
│  │ 描述:       [___________________]                     │  │
│  │             [___________________]                     │  │
│  │             [___________________]                     │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  业务设置                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ ☑ 允许店面间库存共享                                  │  │
│  │ ☑ 允许店面间调货                                      │  │
│  │ ☑ 统一定价策略                                        │  │
│  │ ☑ 中央库存管理                                        │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  群组状态                                                     │
│  ┌──────────────────────────────────────────────────────┐  │
│  │ ☑ 群组激活                                            │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  ┌──────────┐  ┌──────────┐                                │
│  │   保存    │  │   取消    │                                │
│  └──────────┘  └──────────┘                                │
└─────────────────────────────────────────────────────────────┘
```

**字段说明**:
- 📝 **群组名称** - 必填，群组的显示名称（如：星巴克连锁店）
- 🏷️ **群组代码** - 必填，唯一标识（如：STARBUCKS，自动转大写）
- 📄 **描述** - 可选，群组的详细描述
- ⚙️ **业务设置** - 配置群组的业务规则

---

## 🎯 测试步骤可视化

### 步骤 1: 创建第一个群组

```
1. 访问 http://localhost:3000/admin.html
2. 点击 "👥 用户管理" 标签
3. 点击 "👥 群组管理" 按钮（绿色）
4. 点击 "➕ 添加群组"
5. 填写:
   群组名称: 测试连锁店
   群组代码: TEST-CHAIN
   描述: 这是一个测试用的连锁店群组
6. 点击 "保存"
```

**预期结果**: ✅ 显示"保存成功"，群组列表中出现新群组

---

### 步骤 2: 创建管理员用户

```
1. 关闭群组管理模态框
2. 点击 "➕ 添加用户"
3. 填写:
   用户名: test_admin
   邮箱: test_admin@example.com
   密码: 123456
   角色: 管理员
   名字: Test
   姓氏: Admin
4. 确保 "账户激活" 已勾选
5. 点击 "保存"
```

**预期结果**: ✅ 显示"保存成功"，用户列表中出现新用户

---

### 步骤 3: 创建普通用户并关联群组

```
1. 点击 "➕ 添加用户"
2. 填写:
   用户名: test_retail
   邮箱: test_retail@example.com
   密码: 123456
   角色: 普通用户  ← 选择后会显示"群组设置"
3. 在"群组设置"中:
   所属群组: 测试连锁店 (TEST-CHAIN)
   店面类型: 连锁店
   ☑ 可以查看群组内其他店面库存
   ☑ 可以从群组内其他店面调货
4. 点击 "保存"
```

**预期结果**: ✅ 用户创建成功，"所属群组"列显示"测试连锁店"

---

### 步骤 4: 验证群组用户数量

```
1. 点击 "👥 群组管理" 按钮
2. 查看 "测试连锁店" 的用户数量
```

**预期结果**: ✅ 显示 "1 人"

---

### 步骤 5: 测试群组筛选

```
1. 关闭群组管理模态框
2. 在用户列表页面，找到 "群组筛选" 下拉框
3. 选择 "测试连锁店 (TEST-CHAIN)"
```

**预期结果**: ✅ 只显示属于"测试连锁店"的用户

---

### 步骤 6: 测试编辑用户

```
1. 在用户列表中找到 "test_retail"
2. 点击 "编辑" 按钮
3. 修改电话号码: 1234567890
4. 点击 "保存"
```

**预期结果**: ✅ 保存成功，用户信息已更新

---

### 步骤 7: 测试停用用户

```
1. 在用户列表中找到 "test_retail"
2. 点击 "停用" 按钮
3. 确认操作
```

**预期结果**: ✅ 用户状态变为"停用"（红色徽章），按钮变为"启用"

---

### 步骤 8: 测试删除群组限制

```
1. 点击 "👥 群组管理" 按钮
2. 找到 "测试连锁店"（有1个用户）
3. 点击 "停用" 按钮
4. 确认操作
```

**预期结果**: ❌ 显示错误："该群组还有 1 个活跃用户，无法删除"

---

## 🎨 颜色和徽章说明

### 角色徽章
- 🔴 **管理员** - 红色徽章 (#e53e3e)
- 🟡 **仓库管理员** - 黄色徽章 (#ecc94b)
- 🔵 **普通用户** - 蓝色徽章 (#4299e1)

### 状态徽章
- 🟢 **活跃** - 绿色徽章 (#48bb78)
- 🔴 **停用** - 红色徽章 (#e53e3e)

### 群组代码徽章
- 🔵 **群组代码** - 蓝色徽章 (#4299e1)

### 按钮颜色
- 🔴 **主要按钮** - 红色 (#e53e3e) - 如"添加用户"
- 🟢 **成功按钮** - 绿色 (#48bb78) - 如"群组管理"
- ⚪ **次要按钮** - 灰色 (#718096) - 如"取消"

---

## 📊 数据显示格式

### 用户列表
```
用户名    邮箱                    角色        所属群组      状态    操作
admin     admin@example.com      [管理员]    -            [活跃]  [编辑] [停用]
retail1   retail1@example.com    [普通用户]  测试连锁店    [活跃]  [编辑] [停用]
```

### 群组列表
```
群组名称    代码          用户    库存共享  调货  状态    操作
测试连锁店  [TEST-CHAIN]  1 人    ✅       ✅    [活跃]  [编辑] [停用]
```

---

## ⚠️ 常见问题

### Q1: 点击"添加用户"没有反应？
**A**: 检查浏览器控制台（F12）是否有错误，确认JavaScript文件已加载

### Q2: 保存用户时提示"用户名已存在"？
**A**: 用户名必须唯一，请使用不同的用户名

### Q3: 看不到"群组设置"区域？
**A**: 只有选择"普通用户"角色时才会显示，其他角色不显示

### Q4: 无法删除群组？
**A**: 群组内有活跃用户时无法删除，需要先将用户移到其他群组或停用

### Q5: 群组筛选器是空的？
**A**: 需要先创建群组，群组列表才会出现在筛选器中

---

## 🔍 调试提示

### 打开浏览器开发者工具
```
Windows: F12 或 Ctrl+Shift+I
Mac: Cmd+Option+I
```

### 查看控制台日志
```
1. 打开开发者工具
2. 切换到 "Console" 标签
3. 查看是否有错误信息（红色）
```

### 查看网络请求
```
1. 打开开发者工具
2. 切换到 "Network" 标签
3. 筛选 "Fetch/XHR"
4. 执行操作（如创建用户）
5. 查看请求和响应
```

---

## ✅ 成功标志

### 用户管理成功
- ✅ 可以看到用户列表
- ✅ 可以创建新用户
- ✅ 可以编辑用户信息
- ✅ 可以停用/启用用户
- ✅ 筛选和搜索功能正常

### 群组管理成功
- ✅ 可以看到群组列表
- ✅ 可以创建新群组
- ✅ 可以编辑群组信息
- ✅ 可以停用空群组
- ✅ 无法删除有用户的群组

### 用户-群组关联成功
- ✅ 创建用户时可以选择群组
- ✅ 用户列表显示所属群组
- ✅ 群组筛选功能正常
- ✅ 群组用户数量正确

---

**创建时间**: 2026-02-03
**版本**: 1.0
**状态**: ✅ 可视化指南完成

**快速开始**: 访问 http://localhost:3000/admin.html
