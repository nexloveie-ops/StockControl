# 🚀 快速测试：商户入库功能

## 测试时间
2026-02-02

## 测试目标
验证商户手动入库功能是否正常工作

---

## 🎯 3分钟快速测试

### 前置条件
- ✅ 服务器正在运行（进程 9）
- ✅ 访问地址：http://localhost:3000
- ✅ 商户账号：merchant_001 / password（或其他商户账号）

---

### 步骤 1: 登录商户账号（30秒）

1. 访问：http://localhost:3000/merchant.html
2. 使用商户账号登录
3. 进入商户中心

**✅ 检查点**:
- 页面正常加载
- 显示商户统计信息

---

### 步骤 2: 查看库存页面（30秒）

1. 点击"我的库存"标签
2. 查看页面右上角

**✅ 检查点**:
- 页面显示"我的库存"标题
- 右上角有"+ 手动入库"按钮（蓝色）
- 如果没有库存，显示提示信息

---

### 步骤 3: 测试入库功能（2分钟）

1. 点击"+ 手动入库"按钮
2. 填写产品信息：
   - **产品名称**: iPhone 15 Pro 手机壳
   - **品牌**: Apple
   - **型号**: A2848
   - **分类**: 手机配件
   - **数量**: 10
   - **成本价**: 15
   - **批发价**: 20
   - **零售价**: 30
   - **条码**: 123456789
   - **颜色**: 黑色
   - **成色**: 全新
3. 点击"确认入库"

**✅ 检查点**:
- 模态框正常弹出
- 所有字段可以正常输入
- 点击"确认入库"后显示"✅ 入库成功！"
- 模态框自动关闭
- 库存列表自动刷新，显示新添加的产品

---

## 🎉 测试成功标志

如果以上3个步骤都通过，说明入库功能正常！

### ✅ 成功的标志
- "+ 手动入库"按钮显示正常
- 模态框可以正常打开和关闭
- 表单可以正常提交
- 提示"入库成功"
- 库存列表自动更新

### ❌ 如果失败
- 按钮不显示 → 刷新页面（Ctrl+F5）
- 模态框不弹出 → 检查浏览器控制台错误
- 提交失败 → 检查服务器是否运行
- 库存不更新 → 检查 API 响应

---

## 🔍 详细验证

### 验证 1: 检查数据库
使用 MongoDB Compass 连接数据库，查看 `merchantinventories` 集合：

```javascript
// 应该能看到新添加的记录
{
  merchantId: "merchant_001",
  productName: "iPhone 15 Pro 手机壳",
  brand: "Apple",
  model: "A2848",
  category: "手机配件",
  quantity: 10,
  costPrice: 15,
  wholesalePrice: 20,
  retailPrice: 30,
  barcode: "123456789",
  color: "黑色",
  condition: "BRAND_NEW",
  source: "manual",
  status: "active",
  createdAt: ISODate(...),
  updatedAt: ISODate(...)
}
```

### 验证 2: 检查 API 响应
打开浏览器开发者工具（F12），切换到 Network 标签：

1. 点击"+ 手动入库"
2. 填写表单并提交
3. 查看 Network 中的请求

**应该看到**:
```
POST /api/merchant/inventory/add
Status: 200 OK
Response: {
  "success": true,
  "data": {
    "inventoryId": "...",
    "message": "入库成功"
  }
}
```

### 验证 3: 测试多次入库
1. 再次点击"+ 手动入库"
2. 添加不同的产品
3. 验证库存列表中显示多个产品

---

## 📊 功能特点

### 已实现的功能
- ✅ 手动入库界面（模态框）
- ✅ 完整的产品信息输入
- ✅ 表单验证（必填字段）
- ✅ 提交到后端 API
- ✅ 成功提示
- ✅ 自动刷新库存列表
- ✅ 自动刷新统计数据

### 待实现的功能
- ⏳ 群组库存查看
- ⏳ 调货功能
- ⏳ 库存编辑
- ⏳ 库存删除
- ⏳ 批量入库

---

## 🐛 常见问题

### Q1: 点击"+ 手动入库"没有反应
**A**: 
1. 刷新页面（Ctrl+F5）
2. 检查浏览器控制台是否有 JavaScript 错误
3. 确认服务器正在运行

### Q2: 提交后显示"入库失败"
**A**: 
1. 检查所有必填字段是否填写
2. 检查价格是否为有效数字
3. 查看浏览器控制台的错误信息
4. 检查服务器日志

### Q3: 入库成功但库存列表不更新
**A**: 
1. 手动刷新页面
2. 检查 API 返回的数据格式
3. 查看浏览器控制台错误

### Q4: 模态框无法关闭
**A**: 
1. 点击模态框外的灰色区域
2. 点击右上角的 × 按钮
3. 刷新页面

---

## 📝 测试记录

**测试日期**: __________
**测试人员**: __________

| 测试项 | 结果 | 备注 |
|--------|------|------|
| 入库按钮显示 | ⬜ 通过 / ⬜ 失败 | |
| 模态框打开 | ⬜ 通过 / ⬜ 失败 | |
| 表单填写 | ⬜ 通过 / ⬜ 失败 | |
| 提交成功 | ⬜ 通过 / ⬜ 失败 | |
| 库存更新 | ⬜ 通过 / ⬜ 失败 | |

**总体评价**: ⬜ 成功 / ⬜ 失败

**问题记录**: 
_____________________________________________
_____________________________________________

---

## 🎊 下一步

### 如果测试成功
1. ✅ 入库功能已可用
2. 🔄 继续开发群组库存功能
3. 🔄 继续开发调货功能

### 如果测试失败
1. 🔴 查看错误信息
2. 🔴 检查代码实现
3. 🔴 修复问题后重新测试

---

**文档版本**: v1.0
**创建时间**: 2026-02-02
**服务器**: http://localhost:3000
**状态**: ✅ 可以测试
