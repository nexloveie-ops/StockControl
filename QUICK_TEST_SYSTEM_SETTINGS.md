# 🧪 系统设置功能快速测试指南

## 测试环境
- 服务器: http://localhost:3000
- 测试账号: admin / admin123

---

## 测试步骤

### 1️⃣ 访问系统设置页面

#### 方法A: 从管理后台进入
```
1. 访问 http://localhost:3000/admin.html
2. 使用 admin/admin123 登录
3. 点击顶部标签栏的 "⚙️ 系统设置"
4. ✅ 验证: 页面正常跳转到系统设置页面
```

#### 方法B: 直接访问
```
1. 访问 http://localhost:3000/admin-system-settings.html
2. ✅ 验证: 页面正常加载
```

---

### 2️⃣ 测试产品分类管理

#### 查看分类列表
```
1. 默认显示"产品分类"标签页
2. ✅ 验证: 显示现有分类列表
3. ✅ 验证: 每个分类显示完整信息（名称、类型、描述、税率、成色、排序、状态）
```

#### 添加新分类
```
1. 点击"+ 添加分类"按钮
2. 填写分类信息:
   - 分类名称: "测试分类"
   - 分类类型: "手机配件"
   - 描述: "这是一个测试分类"
   - 默认税率: "VAT 23%"
   - 默认成色: "Brand New"
   - 排序权重: 100
3. 点击"保存"
4. ✅ 验证: 提示"分类添加成功"
5. ✅ 验证: 分类列表中出现新添加的分类
6. ✅ 验证: 新分类显示在列表顶部（因为排序权重最高）
```

#### 编辑分类
```
1. 找到刚添加的"测试分类"
2. 点击"编辑"按钮
3. 修改分类名称为: "测试分类（已修改）"
4. 修改描述为: "这是一个修改后的测试分类"
5. 点击"保存"
6. ✅ 验证: 提示"分类更新成功"
7. ✅ 验证: 分类列表中显示更新后的信息
```

#### 删除分类（无产品）
```
1. 找到"测试分类（已修改）"
2. 点击"删除"按钮
3. 在确认对话框中点击"确定"
4. ✅ 验证: 提示"分类删除成功"
5. ✅ 验证: 分类从列表中消失
```

#### 删除分类（有产品）- 测试保护机制
```
1. 找到一个有产品使用的分类（如"手机配件"）
2. 点击"删除"按钮
3. 在确认对话框中点击"确定"
4. ✅ 验证: 提示"删除失败: 无法删除分类，还有 X 个产品使用此分类"
5. ✅ 验证: 分类仍然存在于列表中
```

---

### 3️⃣ 测试设备成色设置

```
1. 点击"设备成色"标签
2. ✅ 验证: 显示三种预设成色
   - Brand New (全新)
   - Pre-Owned (二手)
   - Refurbished (翻新)
3. ✅ 验证: 每种成色都有描述和状态
4. ✅ 验证: 显示提示信息："成色设置为系统核心配置，当前版本不支持自定义修改"
```

---

### 4️⃣ 测试税率设置

```
1. 点击"税率设置"标签
2. ✅ 验证: 显示三种税率
   - VAT 23% (标准税率)
   - VAT 13.5% (减免税率)
   - VAT 0% (免税)
3. ✅ 验证: 每种税率都有适用范围说明
4. ✅ 验证: 显示提示信息："税率设置涉及财务合规，当前版本不支持自定义修改"
```

---

### 5️⃣ 测试系统信息

```
1. 点击"系统信息"标签
2. ✅ 验证: 显示系统基本信息
   - 系统名称: 3C产品库存管理系统
   - 版本: v2.0.0
   - 数据库: MongoDB Atlas
   - 服务器状态: 运行中
   - 最后更新: 当前日期
3. ✅ 验证: 显示数据统计
   - 产品总数
   - 有库存产品
   - 用户总数
   - 供应商总数
   - 采购发票
4. ✅ 验证: 统计数据与实际数据一致
```

---

## 🎯 预期结果

### 功能正常
- ✅ 所有标签页可以正常切换
- ✅ 分类列表正常加载
- ✅ 可以添加新分类
- ✅ 可以编辑现有分类
- ✅ 可以删除无产品的分类
- ✅ 删除有产品的分类时会被阻止
- ✅ 系统信息正常显示

### 界面友好
- ✅ 页面布局清晰
- ✅ 操作按钮明确
- ✅ 有操作提示和说明
- ✅ 模态框操作流畅

### 数据准确
- ✅ 分类信息完整
- ✅ 系统统计准确
- ✅ 状态显示正确

---

## ⚠️ 常见问题

### 问题1: 页面无法访问
**症状**: 访问系统设置页面时显示404错误

**解决方案**:
```bash
# 检查服务器是否运行
curl http://localhost:3000/health

# 检查文件是否存在
ls StockControl-main/public/admin-system-settings.html

# 重启服务器
cd StockControl-main
npm start
```

### 问题2: 分类列表不显示
**症状**: 页面加载后分类列表显示"加载中..."或"加载失败"

**解决方案**:
```bash
# 检查API是否正常
curl http://localhost:3000/api/admin/categories

# 检查数据库连接
curl http://localhost:3000/api/db-status

# 查看浏览器控制台错误信息
# 按F12打开开发者工具，查看Console标签
```

### 问题3: 无法删除分类
**症状**: 删除分类时提示"无法删除分类，还有 X 个产品使用此分类"

**解决方案**:
```
这是正常的保护机制，需要：
1. 进入产品管理页面
2. 找到使用该分类的产品
3. 编辑这些产品，将它们移动到其他分类
4. 确认无产品使用后，再删除分类
```

### 问题4: 权限不足
**症状**: 访问页面时被重定向到登录页面

**解决方案**:
```
1. 确认使用管理员账号登录 (admin/admin123)
2. 检查auth-guard.js是否正确配置
3. 清除浏览器缓存和localStorage
4. 重新登录
```

---

## 📊 测试检查清单

### 基础功能
- [ ] 页面可以正常访问
- [ ] 标签页可以正常切换
- [ ] 分类列表正常加载
- [ ] 系统信息正常显示

### 分类管理
- [ ] 可以添加新分类
- [ ] 可以编辑现有分类
- [ ] 可以删除无产品的分类
- [ ] 删除有产品的分类时被阻止
- [ ] 分类信息完整准确

### 界面体验
- [ ] 页面布局清晰美观
- [ ] 操作按钮响应正常
- [ ] 模态框打开关闭正常
- [ ] 提示信息清晰明确

### 数据准确性
- [ ] 分类数据正确
- [ ] 系统统计准确
- [ ] 状态显示正确

---

## 🚀 快速测试命令

### 测试API
```bash
# 测试分类列表API
curl http://localhost:3000/api/admin/categories

# 测试系统统计API
curl http://localhost:3000/api/admin/stats

# 测试数据库连接
curl http://localhost:3000/api/db-status
```

### 测试页面访问
```bash
# 测试系统设置页面
curl http://localhost:3000/admin-system-settings.html

# 测试管理后台
curl http://localhost:3000/admin.html
```

---

## ✅ 测试完成标准

所有以下项目都通过：
1. ✅ 页面可以正常访问
2. ✅ 所有标签页功能正常
3. ✅ 分类的增删改查功能正常
4. ✅ 删除保护机制工作正常
5. ✅ 系统信息显示准确
6. ✅ 界面友好，操作流畅
7. ✅ 无JavaScript错误
8. ✅ 无API错误

---

**测试时间**: 预计 10-15 分钟
**测试人员**: 管理员
**测试环境**: 本地开发环境
**最后更新**: 2026-02-02
